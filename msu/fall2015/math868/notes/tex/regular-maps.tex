\section{Regular maps}
Let $F: N^n \to M^m$ be a smooth map and $p \in N^n$.
\begin{defn}[Rank]
The \emph{rank of $F$ at $p$} is the rank of its differential
$F_{\ast,p} : T_pN \to T_{f(p)}M$.
\end{defn}

The maximal allowable rank of an
$m \times n$ matrix is $\min\{m, n\}$.
\begin{itemize}
  \item[($n = m$)]{
    If $F$ has full rank at $p$, then $F_{\ast,p}$ is invertible, so
    $F$ is a local diffeomorphism at $p$.
  }
  \item[($n < m$)]{
    If $F$ has maximal rank $n$ at $p$, then $F_{\ast,p}$ is injective. We
    say that $F$ is an \emph{immersion} at $p$. The prototype of this
    case is the inclusion map $\mathbb{R}^n \hookrightarrow \mathbb{R}^{n+k}$.
  }
  \item[($n > m$)]{
    If $F$ has maximal rank $m$ at $p$, then $F_{\ast, p}$ is
    surjective. We say that $F$ is a \emph{submersion} at $p$. The
    prototype of this case is the projection map
    $\mathbb{R}^n \to \mathbb{R}^{n-k}$.
  }
\end{itemize}

We will show that when $F$ is an immersion/submersion that local
coordinates can be identified such that locally $F$ looks like these
prototype functions.

\begin{remark}
If $F_{\ast, p}$ has maximal rank, then $F_{\ast, u}$ does as well for
all $u$ sufficiently close to $p$, i.e. having maximal rank is an open
condition. Choose coordinates $(U, x^1, \dots, x^n)$ at $p$
and $(V, y^1, \dots, y^m)$ at $f(p)$. Let
$F^i = y^i \circ F : U \to \mathbb{R}$ be component functions. Then
$F_{\ast, p} = \left[\frac{\partial F^i}{\partial x^j}\right]$ has
rank $k$. Then there is some $k \times k$ minor with nonzero
determinant. Any minor of larger size has zero determinant,
 and the determinant is a continuous function.
\end{remark}

We wish to give normal forms for maps with constant rank (potentially
not maximal) on an open neighborhood.

\begin{theorem}
Let $O \subset \mathbb{R}^n$ be an open set and
$F: O \to \mathbb{R}^m$ be smooth.
If $F \in C^\infty$ and has constant rank $k$ on a neighborhood of
some point $p \in O$, then $F$ has a \emph{normal form} in a
neighborhood of $p$, i.e. there exist neighborhoods
$\tilde{U}$ of $p$ and $\tilde{V}$ of $F(p)$ and
$C^\infty$ maps
$\tilde{\phi}: \tilde{U} \to \tilde{\phi}(\tilde{U}) \subset \mathbb{R}^n$
that carries $p \mapsto 0$ and
$\tilde{\psi} : \tilde{V} \to \tilde{\psi}(\tilde{V})$ that carries
$F(p) \mapsto 0$ such that
$$
  (\tilde{\psi} \circ F \circ \tilde{\phi}^{-1})
    (r^1, \dots, r^n)
= (r^1, \dots, r^k, 0, \dots, 0).
$$
\end{theorem}

\begin{remark}
Tu's appendix has a proof of the special case $n = m = 2$ and $k = 1$,
which models more or less the proof of the preimage theorem. Tu also
explains that this is equivalent to the inverse function theorem.
\end{remark}

Assuming this statement for Euclidean spaces, we deduce its extension
to manifolds as follows.

\begin{theorem}[Constant Rank Theorem]
Let $F: N^n \to M^m$ be a smooth map with constant rank in some
neighborhood of a point $p$. Then there exist coordinate charts
$(U, \phi)$ and $(V, \psi)$ centered at $p$, $F(p)$ such that
$\psi F \phi^{-1}: \phi(U) \to \psi(V)$ is given by
$$
  \psi F \phi^{-1}
    (r^1, \dots, r^n)
= (r^1, \dots, r^k, 0, \dots 0).
$$
\end{theorem}

\begin{proof}
Choose coordinates $(U_1, \phi_1)$ and $(V_1, \psi_1)$ centered at
$p$, $F(p)$ such that $F$ has constant rank $k$ on $U_1$. Then
$\psi_1 F \phi_1^{-1}$ is a map between Euclidean spaces with a rank
that coincides with the rank of $F$ (by the chain rule). Therefore
from the theorem above we have charts on $\mathbb{R}^n$ and
$\mathbb{R}^m$ given by
$(\tilde{U}, \tilde{\phi})$ and $(\tilde{V}, \tilde{\psi})$ such that
$$
  \tilde{\psi_1} \psi_1 F \circ \phi_1^{-1} \tilde{\phi_1}^{-1}
    (r^1, \dots, r^n)
=   (r^1, \dots, r^k, 0, \dots 0)
$$
so we let $\phi = \tilde{\phi_1} \circ \phi_1$ and
$\psi = \psi_1 \circ \tilde{\psi_1}$.
\end{proof}

\begin{corol}
If $F: N^n \to M^m$ is an immersion at $p$ then there exist
coordinates centered at $p$, $F(p)$ such that $F$ locally has the form
of an inclusion $(r^I) \mapsto (r^I, 0, \dots, 0)$. If $F$ is a
submersion at $p$ then there are charts that make it locally look like
a projection.
\end{corol}

\begin{defn}
We say a map $F$ is a submersion (immersion) if it is at all points $p
\in N^n$.
\end{defn}

\begin{corol}
If $F$ is a submersion, then it is an open map.
\end{corol}

\begin{proof}
It is sufficient to show that a linear projection $\pi$ is an open map.
\end{proof}

\begin{theorem}[Regular value theorem for maps of constant rank]
Let $F: N^n \to M^m$ and $c \in M^m$ with $F^{-1}(c) \neq
\varnothing$. If $F$ has constant rank $k$ on a neighborhood of
$F^{-1}(c)$, then the level set $S = F^{-1}(c)$ is an embedded
(regular) smooth submanifold of $N^n$ of codimension $k$.
\end{theorem}

\begin{proof}
Let $p \in F^{-1}(c)$. We wish to show that $p$ has an adapted
coordinate chart $U$, i.e. one for which $S \cap U$ is defined by the
common vanishing of $k$ coordinate functions. Let $(U, \phi)$ and
$(V, \psi)$ be centered charts at $p$, $F(p)$ as in the proof of the
constant rank theorem, so that
$\psi F \phi^{-1} = (r^1, \dots, r^k, 0, \dots 0)$. Then
\begin{align*}
   U \cap S
&= \{ u \in U ~\vert~ F(u) = c \} \\
&= \{ u \in U ~\vert~ \psi F(u) = 0 \} \\
&= \{ u \in U ~\vert~ r^i \psi F(u) = 0 \forall i = 1, \dots, m \} \\
&= \{ u \in U ~\vert~ \phi(u) \text{ has its first $k$ coordinates 0}
   \} \\
&= \{ u \in U ~\vert~ (r^i \circ \phi)(u), i=1, \dots, k \} \\
&= \{ u \in U ~\vert~ x^i(u) = 0, i=1, \dots, k \}.
\end{align*}
\end{proof}

We are now interested in cases when the image of a smooth map $F: N
\to M$ is or is not an embedded submanifold of $M$.

\begin{enumerate}
  \item{
    If $F$ is surjective, its image is an embedded submanifold.
  }
  \item{
    If $N$ is compact, $M$ is connected, and $F$ is a submersion then
    $F$ is surjective.
  }
  \item{
    For example, $F: \mathbb{R} \mapsto \mathbb{R}^2$ given by
    $f(t) = (t^2, t^3)$ (the \emph{cuspoidal cubic}, so called since
    $y^2 = x^3$) is \emph{not} an embedded submanifold. We see that
    $$
      F_{ast, t}
        \left(
          \frac{\dif}{\dif t}
        \right)
    = \left[
        \begin{array}{c}
          2t \\ 3t^2
        \end{array}
      \right]
    $$
    which is injective except when $t = 0$, i.e. $F$ is an immersion
    except at $t = 0$.
  }
  \item{
    A non-injective immersion is given by
    $F(t) = (t^2 - 1, t^3 - t)$, which has differential
    $$
      F_{ast, t}
        \left(
          \frac{\dif}{\dif t}
        \right)
    = \left[
        \begin{array}{c}
          2t \\ 3t^2 - 1
        \end{array}
      \right]
    $$
    which is never zero. The locus of points
    $x = t^2 - 1$ is given by
    $$
      y^2
    = (t^3 - t)^2
    = (tx)^2
    = x^3 + x^2.
    $$
    This is called the \emph{nodal cubic}, and is an immersion but not
    an embedding because the origin has no neighborhood that looks
    like a copy of $\mathbb{R}$ in $\mathbb{R}^2$.
  }
  \item{
    An injective immersion whose image is not an embedded submanifold
    is the map $F: (-\infty, 1) \to \mathbb{R}^2$ given by
    $$
      F(t)
    = \left(
        \frac{t^2 - 1}{t^2 + 1},
        \frac{t(t^2 - 1)}{t^2 + 1}
      \right)
    $$
  }
\end{enumerate}

We have now seen a notion of a regular (or embedded) submanifold,
where each point $s \in S \subset M$ has an adapted chart $(U, \phi)$
realizing $U \cap S$ as the common zeros of the coordinate
function. We have also seen that if $S$ is a regular submanifold then
it is a smooth manifold when endowed with the subspace topology. We
have also seen that the image of an immersion is not in general a
regular submanifold, even if the immersion is injective.

\begin{defn}[Smooth embedding]
A smooth map $F: N \to M$ is an \emph{embedding} if $F$ is a
one-to-one immersion and $F : N \to F(N)$ is a homeomorphism when
$F(N) \subset M$ is given the subspace topology.
\end{defn}

We wish to show that regular submanifolds of some manifold $M$ are in
unique correspondence with images $F(N)$ of smooth embeddings.

\begin{prop}
Let $F: N \to M$ be a smooth embedding. Then $F(N) \subset M$ is a
regular submanifold of $M$.
\end{prop}

\begin{proof}
Let $q \in F(N)$. We wish to show that $q$ has an adapted chart.
Since $F$ is injective, there is a unique $p \in N$ such that
$F(p) = q$. Let $(U, x^1, \dots, x^n)$ and $(Y, y^1, \dots, y^n)$ be
immersion charts at $p$ and $F(p) = q$, with $F(U) \subset V$, such that
$(y^i \circ f)(u) = x^i(u)$, $i = 1, \dots, n$
and $(y^i \circ f)(u) = 0$ for $i = n+1, \dots, m$.

Since $F$ is a homeomorphism onto its image and $F(N)$ has the
subspace topology, $F(U)$ is an open set in $F(N)$ since $U$ is open
in $N$. Therefore there exists some $V^\prime$ open in$M$ such that
$F(U) = F(N) \cap V^\prime$. Then $(V^\prime, y^1, \dots, y^m)$ is an
adapted chart, since in $V^\prime$ we have
$$
  V^\prime \\cap F(N)
= \{ v \in V^\prime ~\vert~ y^i(v) = 0, i = n+1, \dots, m \}.
$$
\end{proof}

\begin{prop}
Suppose $N^n \subset M^m$ is a regular submanifold. Then the inclusion
$i : N^n \to M^m$ is an embedding.
\end{prop}

\begin{proof}
Since $i$ is a homeomorphism onto its image, we need only to check
that $i$ is an immersion. Let $n \in N$. Since $N \subset M$ and $N$ is a regular
submanifold of $M$, there exists a coordinate chart for $M$ centered
at $n$ adapted for the subset $N$. Then
$$
  V \cap N
= \{ v \in V ~\vert~ y^{n+1}(v) = \cdots = y^m(v) = 0 \}.
$$
Since $n \in N$, the domain, we have that
$(V \cap N, y^1, \dots, y^n)$ is a coordinate chart in $N$'s induced
manifold structure. On $V \cap N$,
$i(y^1, \dots, y^n) = (y^1, \dots, y^n, 0, \dots 0)$, so $i$ is an immersion.
\end{proof}

A topology on the image of a one-to-one immersion that is not the
subspace topology is the topology on $F(N)$ for which
$F: N \to F(N)$ is declared to be a homeomorphism, i.e.
$V \subset F(N)$ is open if and only if $F^{-1}(V)$ is open in $N$.
This topology depends on the map $F$. We see that an injective
immersion $F$ is an embedding if and only if the subspace topology
agrees with this topology. If $F : N \to M$ is an injective immersion,
then $F(N)$ with the immersion topology is called an \emph{immersed}
submanifold.

\begin{xmpl}
The ``figure-8'' can be realized by maps
$f, g: \left(-\frac{\pi}{2}, \frac{3 \pi}{2}\right) \to S$, where
$$
f(t) = (\cos t, \sin 2t), \quad
g(t) = (\cos t, -\sin 2t)
$$
Notice that the images of these maps are not regular submanifolds,
since no neighborhood of 0 looks like the domain. We can observe that
the segments of this figure-8 passing through the origin are open in
the immersion topology of one map but not the other.
\end{xmpl}

\subsection{Restricting the target of a map}
Let $F: N^n \to M^m$ be smooth and $S^s \subset M^m$ be a submanifold,
either immersed or embedded, so $F(N^n) \subset S^s$. Then there is a
map $\tilde{F} : N^n \to S^s$ given by $\tilde{F}(n) = F(n)$. This map
is not smooth in general. For example, $f$ from the previous example
is smooth with image in $S$, but $\tilde{f} : (-\pi/2, 3\pi/2) \to S$
is not even continuous because $\tilde{f}^{-1}(AB)$ is not open in
$(-\pi/2, 3\pi/2)$ but is open in $S$.

\begin{prop}
Let $F : N^n \to M^m$, and $S^s \subset M^m$ be an embedded
submanifold with $F(N) \subset S$. Then
$\tilde{F}: N \to S$ is $C^\infty$.
\end{prop}

\begin{proof}
Let $n \in N$ and consider a chart $(U, x^1, \dots, x^n)$ and an
adapted chart $(V, y^1, \dots, y^m)$ centered at $n$,
$\tilde{F}(n) = F(n)$ respectively. Then
$y^i \circ F : U \to \mathbb{R}$ are smooth maps on $U$. Note that
$$
  S \cap V
= \{ v \in V ~\vert~ y^{s+1}(v) = \cdots = y^m(v) = 0 \},
$$
so let $(S \cap V, y^1, \dots, y^s)$ be coordinates on $S$ near
$F(n)$. Then $y^i \circ F = y^i \circ \tilde{F} : U \to \mathbb{R}$ is
$C^\infty$ for all $i=1, \dots, s$.
\end{proof}

\begin{xmpl}[Kronecker's winding line]
Regard $S^1 \subset \mathbb{C} \simeq \mathbb{R}^2$. Take
$\alpha \in \mathbb{R} \setminus \mathbb{Q}$. Take
$\mathbb{R} \to S^1 \times S^1 = T^2 \subset \mathbb{C} \times
\mathbb{C} \simeq \mathbb{R}^4$ given by
$$
  f(t)
= (e^{2 \pi i t}, e^{2 \pi i \alpha t})
= (\cos 2 \pi t, \sin 2 \pi t, \cos 2 \pi \alpha t, \sin 2 \pi \alpha t).
$$
This is a group homomorphism from the additive group on $\mathbb{R}$ to the direct
product $S^1 \times S^1$.

Let $f(t) = (1, 1)$. Then $t \in \mathbb{Z}$ and $t \in \alpha
\mathbb{Z}$. But $\alpha$ is irrational, so $\ker f = 0$ and therefore
$f$ is injective.

The differential is given by
$$
  f_{\ast, t}
= \left[
    \begin{array}{r}
      -2 \pi \sin 2 \pi t \\
       2 \pi \cos 2 \pi t \\
      -2 \pi \alpha \sin 2 \pi \alpha t \\
       2 \pi \alpha \cos 2 \pi \alpha t
    \end{array}
  \right]
$$
which is nowhere zero. Therefore $f(\mathbb{R})$ is an immersed
submanifold, a subgroup of $S^1 \times S^1$, and in fact
$f(\mathbb{R})$ is a dense subset of $S^1 \times S^1$.

However, $f$ is not an embedding since
$f: \mathbb{R} \to f(\mathbb{R})$ is not a homeomorphism when
$f(\mathbb{R})$ has the subspace topology. Note that $0$ is not a
limit point of $\mathbb{Z} \subset \mathbb{R}$, but $f(0)$ is a limit
point of $f(\mathbb{Z})$, and limit points are invariant under
homeomorphism.

Let $\varepsilon > 0$. We wish to find $k \in \mathbb{Z}$ such that
$\| f(0) - f(k) \| < \varepsilon$ with the Euclidean norm on
$\mathbb{R}^4$. Since $f$ is injective, $f(\mathbb{Z})$ is an infinite
subset of the compact space $S^1 \times S^1$, and therefore has an
accumulation point $(z, w)$. Therefore let $n_1, n_2 \in \mathbb{Z}$
so that $\| f(n_1) - (z, w) \| < \frac{\varepsilon}{2}$ and
$\| f(n_2) - (z, w) \| < \frac{\varepsilon}{2}$. Let $k = n_1 -
n_2$. Then
\begin{align*}
   \| f(k) - f(0) \|
&= \| (e^{2 \pi i(n_1 - n_2)}, e^{2 \pi i \alpha (n_1 - n_2)})
    - (1, 1) \| \\
&= \| (e^{-2 \pi i n_2}, e^{-2 \pi i n_2})
      (e^{2 \pi i n_1} - e^{2 \pi i n_2},
       e^{2 \pi i \alpha n_1} - e^{2\pi i \alpha n_2}) \| \\
&\leq K\|f(n_1) - f(n_2)\|
 <    K \tilde{\varepsilon}.
\end{align*}
\end{xmpl}

\begin{prop}
If $F: N \to M$ is an injective immersion with $N$ compact, then $F$
is an embedding.
\end{prop}
\begin{proof}
We need to show that when $F(N)$ is endowed with the subspace topology,
$F: N \to F(N)$ is a homeomorphism from a from a compact space to a
Hausdorff space and is continuous and bijective and has a continuous
closed inverse.
\end{proof}

\begin{defn}[Proper map]
Let $F: X \to Y$ be continuous. $F$ is a \emph{proper map} when
$F^{-1}(K)$ is compact whenever $K$ is compact.
\end{defn}

The Kronecker winding map is not proper.

\begin{prop}
A proper injective immersion is an embedding.
\end{prop}
