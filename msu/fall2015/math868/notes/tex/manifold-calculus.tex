\section{Calculus on manifolds}
Let $M$ be a smooth manifold and $p \in M$, with
$C_p^\infty(M)$ the set of germs of smooth functions at $p$, i.e. the
$\mathbb{R}$-algebra of equivalence classes of pairs $(U, f)$, where
U is open, $f: U \to \mathbb{R}$ is smooth and $p \in U$, where two
such pairs are equivalent when
$\exists p \in U \subset U_1 \cap U_2$ with $f_1 = f_2$ on $U$.

Point derivations of $C_p^\infty(M)$ are $\mathbb{R}$-linear maps
$D: C_p^\infty(M) \to \mathbb{R}$ such that
$D(fg)(p) = D(f) g(p) + f(p) D(g)$.

The tangent space $T_pM$ of $M$ at $p$ is the $\mathbb{R}$-vector space of
point derivations of $C_p^\infty(M)$.

\begin{defn}[Differential]
The \emph{differential} of a smooth map $F: N \to M$ at $p$ is a
smooth map
$$
(F_\ast)_p = F_{\ast,p} = D_p F : T_p N \to T_{F(p)} M.
$$
For any $X_p \in T_pN$, $g \in C_{F(p)}^\infty M$, this acts as
$$
F_{\ast,p}(X_p)(g) \triangleq X_P(g \circ F).
$$
\end{defn}

\begin{prop}
  \begin{enumerate}
    \item{
      Given $F: N \to M$ and $G: M \to P$,
      $$
        (G \circ F)_{\ast, p}
      = G_{\ast, F(p)} \circ F_{\ast, p}.
      $$
    }
    \item{
      The differential of $\id_M$ is $\id_{T_pM}$.
    }
  \end{enumerate}
\end{prop}
\begin{proof}
  \begin{enumerate}
    \item{
      Let $X_p \in T_pM$ and $g \in C_{f(p)}^\infty(P)$. Then
      \begin{align*}
         G_{\ast, f(p)} \circ F_{\ast, p} (X_p) g
      &= G_{\ast, f(p)} (F_{\ast, p} (X_p)) g \\
      &= F_{\ast p}(X_p) (g \circ G) \\
      &= X_p(g \circ G \circ F) \\
      &= (G \circ F)_{\ast, p}(X_p)(g).
      \end{align*}
    }
    \item{
      $$
        \id_{\ast,p}(X_p)(g)
      = X_p(g \circ \id_M)
      = X_p(g).
      $$
    }
  \end{enumerate}
\end{proof}

\begin{remark}
For $p \in U \subset M$ with $U$ open,
$C_p^\infty(U) = C_p^\infty(M)$, so $T_pU = T_pM$.
\end{remark}

\begin{corol}
If $F: N \to M$ is a local diffeomorphism, then
$F_{\ast, p} : T_p N \to T_{f(p)} M$ is an isomorphism of vector spaces.
\end{corol}
\begin{proof}
If $F$ has a $C^\infty$ inverse $F^{-1} : M \to N$ at $p$, then
$$
    (F \circ F^{-1})_{\ast, F(p)}
  = (\id_M)_{\ast, F(p)}
  = \id_{T_{F(p)}}
$$
and likewise $(F^{-1} \circ F)_{\ast, p} = \id_{T_pN}$.
\end{proof}

\subsection{Basis for $T_pM$}
Let $(U, x^1, \dots, x^m)$ be a coordinate chart about $p$
and $\phi$ be a chart to $(\mathbb{R}^m, r^1, \dots, r^m)$.
Recall that $T_{\phi(p)} \mathbb{R}^m$ has basis
$\left.\frac{\partial}{\partial r^i}\right|_{\phi(p)}$.
Then form
$\left\{ \left.\frac{\partial}{\partial x^i}\right|_p \right\}_{i=1}^m$.
Since $\phi$ is a diffeomorphism onto its image,
$\phi_\ast : T_pM \to T_{\phi(p)} \mathbb{R}^m$ is an isomorphism. We
compute
\begin{align*}
   \phi_{\ast,p}
     \left(
       \left.
         \frac{\partial}{\partial x^i}
       \right|_p
     \right)(g)
&= \left.
     \frac{\partial}{\partial x^i}
   \right|_p
     (g \circ \phi) \\
&= \frac{\partial (g \circ \phi \circ \phi^{-1})}
        {\partial r^i}
   (\phi(p)) \\
&= \frac{\partial g}{\partial r^i}(\phi(p)) \\
&= \left.\frac{\partial}{\partial r^i}\right|_{\phi(p)} g.
\end{align*}
Therefore
$$
  \phi_\ast
    \left(
      \left.
        \frac{\partial}{\partial x^i}
      \right|_p
    \right)
= \left.
    \frac{\partial}{\partial r^i}
  \right|_{\phi(p)}.
$$
This shows that
$\left\{ \left.\frac{\partial}{\partial x^i}\right|_p
\right\}_{i=1}^m$
is an induced basis for $T_pM$.

\begin{corol}
$\dim T_p M = \dim M = m$. Consequently
$\mathbb{R}^n$ and $\mathbb{R}^m$ are not diffeomorphic if
$n \neq m$. They are not homeomorphic either, but this is more
difficult to show.
\end{corol}

\subsection{Change of coordinates}
Let $p \in M$ and $(U, x^1, \dots, x^m)$, $(V, y^1, \dots, y^m)$ be
coordinates about $p$, with bases $\{\partial_{x^i}|_p\}$ and
$\{\partial_{y_i}|_p\}$. Then we can write
$$
  \left.
    \frac{\partial}{\partial x^j}
  \right|_p
= \sum_{k=1}^m
    a_j^k
    \left.\frac{\partial}{\partial y^k}\right|_p
$$
for some unique coefficients $a_j^k$.

Evaluating both sides on $y^i: U \cap V \to \mathbb{R}$ gives
\begin{align*}
   \sum_{k=1}^n
     a_j^k
     \frac{\partial y^i}{\partial y^k}(p)
&= \sum_k a_j^k \delta_k^i = a_j^i
\end{align*}
so that
$$
  \left.\frac{\partial}{\partial x^j}\right|_p
= \sum_{i=1}^m
    \frac{\partial y^i}{\partial x^j}
    \left.
      \frac{\partial}{\partial y^i}
    \right|_p.
$$

\subsection{Differential in coordinates}
Let $F: N \to M$ with a chart $(U, x, \phi)$ at
$p$ and $(V, y, \psi)$ at $F(p)$. We see that
$$
  F_{\ast,p}
  \left(
    \left.
      \frac{\partial}{\partial x^j}
    \right|_p
  \right)
= \sum_{k=1}^n
    a_m^k
    \left.
      \frac{\partial}{\partial y^k}
    \right|_{F(p)}
$$
for some $a_m^k$. To determine $a_m^k$, let both sides act as a
derivation on $y^i: V \to \mathbb{R}$ so that
\begin{align*}
   F_{\ast, p}
     \left(
       \left.
         \frac{\partial}{\partial x^j}
       \right|_p
     \right)(y^i)
&= \left.
     \frac{\partial}{\partial x^j}
   \right|_p
     (y^i \circ F)
 = \frac{\partial F^i}{\partial x^j}(p)
\end{align*}
whereas
$$
  \left(
    \sum_{k=1}^m
      a_j^k
      \left.
        \frac{\partial}{\partial y^k}
      \right|_{F(p)}
  \right)
    (y^i)
= \sum_{k=1}^n
    a_j^k
    \frac{\partial y^i}{\partial y^k}
= a^i_j.
$$
Therefore in coordinates $F_{\ast,p} = J(F)(p).$

\begin{theorem}[Coordinate-free inverse function theorem]
$F: N \to M$ is a local diffeomorphism at $p$ if and only if
$F_{\ast,p}$ is invertible.
\end{theorem}

\section{Curves}
\begin{defn}[Curve]
A \emph{curve} on a manifold $M$ is a smooth map
$c: (a, b) \to M$ from an interval to the manifold.
\end{defn}

The basis of the tangent space $T_{t_0} (a, b)$ is given by
$$
  \left.\frac{\partial}{\partial t}\right|_{t_0}
= \left.\frac{\dif}{\dif t}\right|_{t_0},
$$
so the \emph{velocity vector} to $c$ at time $t = t_0$ is
$$
           c^\prime(t_0)
\triangleq c_{\ast, t_0}
             \left(
               \left.\frac{\dif}{\dif t}\right|_{t_0}
             \right)
\in T_{c(t_0)} M.
$$

\subsection{Notation}
Let $c: (a, b) \to \mathbb{R}$ be a curve. We have two types of
derivative:
\begin{itemize}
  \item{
    the ordinary derivative from calculus ($c$ is a real function) given by
    $$
      \dot{c}(t_0)
    = \lim_{h \to 0}
        \frac{c(t_0 + h) - c(t_0)}{h}
    \in \mathbb{R}
    $$
  }
  \item{
    the velocity vector (i.e. total derivative) treating $c$ as a
    curve
    $$
      c^\prime(t_0)
    = c_{\ast, t_0}
        \left(
          \left.\frac{\dif}{\dif t}\right|_{t_0}
        \right)
    \in T_{c(t_0)} M.
    $$
  }
\end{itemize}
These notions are related since we can write
$$
  c^\prime(t_0)
= \alpha(t_0)
  \left.\frac{\dif}{\dif r}\right|_{c(t_0)}
$$
for some $\alpha(t_0)$ since $T_{c(t_0)}\mathbb{R}$ is a
one-dimensional vector space.
To determine this, evaluate both sides on the coordinate function
$r: \mathbb{R} \to \mathbb{R}$ to see
\begin{align*}
   c^\prime(t_0) r
&= c_{\ast, t_0}
     \left(
       \left.\frac{\dif}{\dif t}\right|_{t_0}
     \right) r
 = \left.\frac{\dif}{\dif t}\right|_{t_0} (r \circ c) \\
&= \left.\frac{\dif}{\dif t}\right|_{t_0} (c(t))
 = \dot{c}(t_0)
\end{align*}
whereas
$$
  \alpha(t_0)
  \left.\frac{\dif}{\dif r}\right|_{c(t_0)} r
= \alpha(t_0)
$$
so that $\alpha(t_0)$ is precisely the classical derivative.

\subsection{Velocity vectors for curves}
Writing $c^i(t) = r^i(c(t))$, we have
$$
  c(t)
= (c^1(t), \dots, c^n(t)) \in \mathbb{R}^n
$$
so that
$$
  c^\prime(t)
= \sum_i
    a^i(t)
    \left.\frac{\partial}{\partial r^i}\right|_t.
$$
This gives $\dot{c}^j(t) = a^j(t)$ so that
$$
  c^\prime(t)
= \sum_i
    (\dot{c}^i)(t)
    \left.\frac{\partial}{\partial r^i}\right|_t.
$$
In calculus, we write
$$
  c^\prime(t)
= \langle
    (\dot{c^1})(t), \dots, (\dot{c^n})(t)
  \rangle
$$

Every tangent vector is a velocity of many curves.
\begin{lemma}
Let $M$ be a manifold, $p \in M$, and $X_p \in T_pM$.
Then there is a curve
$$
c: (-\varepsilon, \varepsilon) \to M
$$
with $c(0) = p$, $c^\prime(0) = X_p$.
\end{lemma}

\begin{proof}
Let $(U, \phi) = (U, x^1, \dots, x^n)$ be a coordinate chart centered
at $p$, i.e. $\phi(p) = 0 \iff x^1(p) = \cdots = x^n(p) = 0$. We write
$$
  X_p
= \sum_i
    a^i \left.\frac{\partial}{\partial x^i}\right|_p
\in T_p M
$$
so that
\begin{align*}
   \phi_{\ast, p}(X_p)
&= \sum_i
     a^i \phi_{\ast, p}
     \left(
       \left.\frac{\partial}{\partial x^i}\right|_p
     \right) \\
&= \sum_i
     a^i
     \left.\frac{\partial}{\partial r^i}\right|_0
\in T_0 \mathbb{R}^n.
\end{align*}
Let $\tilde{c} : (-\varepsilon, \varepsilon) \to \phi(U)$ be given by
$$
  \tilde{c}(t)
= (a^1 t, \dots, a^n t).
$$
We can check that $\tilde{c}(0) = 0$ and
$\tilde{c}^\prime(0) = \phi_{\ast, p}(X_p)$.
Then we let
$c : (-\varepsilon, \varepsilon) \to U \subset M$ be given by
$c = \phi^{-1} \circ \tilde{c}$ so that
$$
  c(0)
= \phi^{-1}(\tilde{c}(0))
= \phi^{-1}(0)
= p
$$
and
\begin{align*}
   c^\prime(0)
&= c_{\ast,0}
     \left(
       \left.\frac{\dif}{\dif t}\right|_0
     \right)
 = (\phi^{-1} \circ \tilde{c})_{\ast, 0}
     \left(
       \left.\frac{\dif}{\dif t}\right|_0
     \right) \\
&= \phi^{-1}_{\ast, 0}
     \left(
       tilde{c}_{\ast, 0}
       \left(
         \left.\frac{\dif}{\dif t}\right|_0
       \right)
     \right)
 = \phi^{-1}_{\ast, 0}(\tilde{c}^\prime(0)) \\
&= \phi^{-1}_{\ast, 0}(\phi_{\ast,p}(X_p))
 = X_p.
\end{align*}
\end{proof}

Note that we could have instead started by defining tangent vectors at
a point $p$ to be equivalence classes of germs at $p$. The definition
using derivations is nice because it immediately provides the vector
space structure to the tangent space. Curves are however nicer to work
with. We usually evaluate the differential using the following rule.

\begin{prop}
Let $F: N \to M$ be a smooth map between manifolds and
$p \in N$, $X_p \in T_p N$. If $c(t)$ is a curve in $N$ with
$c(0) = p$ and $c^\prime(0) = X_p$, then
$$
  F_{\ast, p}(X_p)
= (F \circ c)^\prime(0) \in T_{F(p)} M.
$$
\end{prop}
\begin{proof}
\begin{align*}
   F_{\ast, p}(X_p)
&= F_{\ast, p}(c^\prime(0))
 = F_{\ast, p}
     \left(
       c_{\ast,0}
       \left(
         \left.\frac{\dif}{\dif t}\right|_0
       \right)
     \right) \\
&= (F \circ c)_{\ast, 0}
     \left(
       \left.\frac{\dif}{\dif t}\right|_0
     \right) \\
&= (F \circ c)^\prime(0).
\end{align*}
\end{proof}

\begin{remark}
This proposition is particularly useful for working with maps between
Euclidean spaces and/or submanifolds of Euclidean spaces.
\end{remark}

\begin{xmpl}
$\mathrm{GL}_n(\mathbb{R})$ is the complement of the set of $n \times
n$ matrices with determinant 0, and so this sits inside $\mathbb{R}^{n
  \times n}$ as an open subset. If $g \in \mathrm{GL}_n(\mathbb{R})$,
then $T_g \mathrm{GL}_n(\mathbb{R}) = T_g \mathbb{R}^{n \times n}$.
Writing tangent vectors in terms of a basis for the tangent space gives
$$
\sum
  \beta^i_j \frac{\partial}{\partial a^1_j}
$$
and so we have a map
$T_g \mathbb{R}^{n \times n} \to \mathbb{R}^{n \times n}$ given by
$$
\sum
  \beta^i_j \frac{\partial}{\partial a^1_j}
\mapsto
  \beta^i_j.
$$
We have a left-multiplication map
$$
L_g: \mathrm{GL}_n(\mathbb{R}) \to \mathrm{GL}_n(\mathbb{R})
$$
given by $A \mapsto gA$. We will evaluate
$(L_g)_{\ast, \id} : T_I \mathrm{GL}_n(\mathbb{R}) \to T_g \mathrm{GL}_n(\mathbb{R})$.
Let $X \in T_I \mathrm{GL}_n(\mathbb{R}) = \mathbb{R}_{n \times
  n}$. We want a curve
$c: (-\varepsilon, \varepsilon) \to \mathrm{GL}_n(\mathbb{R})$ with
$c(0) = \id$ and $c^\prime(0) = X$, so let $c(t) = I \to t X$. For
small $t$ this is invertible since the determinant is continuous. Then
\begin{align*}
   (L_g)_{\ast, \id}(X)
&= (L_g \circ c)^\prime(0)
 = (gI + tgX)^\prime(0)
 = gX,
\end{align*}
so the derivative of left-multiplication is again left-multiplication.
\end{xmpl}

\section{Submanifolds}
Level sets of smooth functions $F: N^n \to M^m$, with $n \geq m$, are
generically smooth submanifolds of $N^n$ of dimension $n - m$. Here a
level set is a subset of the form $F^{-1}(\{c\})$.

\subsection{Embedded (regular) submanifolds}

\begin{defn}[Embedded submanifold]
A subset $S$ of a $C^\infty$ $n$-manifold $N^n$ is a
\emph{$k$-dimensional embedded} or \emph{regular submanifold} if
locally, $S$ is the common zero set of $n - k$ coordinate functions in
some chart of $N^n$. That is,
$\forall p \in S$, $\exists (U, \phi) = (U, x^1, \dots, x^n)$ a chart
about $p$ and $n - k$ distinct indices $i_1, \dots, i_{n-k} \in \{ 1,
\dots, n \}$ such that
$$
U \cap S = \{ u \in U \vert x^{i_1}(u) = \cdots = x^{i_{n-k}}(u) = 0 \}.
$$
\end{defn}

\begin{defn}[Codimension]
If $S$ is a $k$-dimensional submanifold of an $n$-manifold, then $n -
k$ is the \emph{codimension} of $S$.
\end{defn}

\begin{remark}
  \begin{enumerate}
    \item{
      Without loss of generality,
      $$
      U \cap S = \{ u \in U \vert x^{k+1}(u) = \cdots = x^n(u) = 0 \}
      $$
      because permutations of the indices
      $\sigma: \mathbb{R}^n \to \mathbb{R}^n$ given by
      $\sigma(r^1, \dots, r^n) = (r^{\sigma(1)}, \dots,
      r^{\sigma(n)})$ is a diffeomorphism.
    }
    \item{
      The chart $(U, \phi)$ in the definition is said to be
      \emph{adapted to $S$}.
    }
    \item{
      A prototypical embedded submanifold is given by
      $$
      R^k \simeq S = \{ (r^1, \dots, r^k, 0, \dots, 0) \}
      $$
      in $\mathbb{R}^n$. Indeed any embedded submanifold looks locally
      like $R^k$ embedded in $R^n$ in this way.
    }
    \item{
      These objects are called submanifolds because they possess a
      submanifold structure.
      Under the subspace topology $S$ inherits the Hausdorff and
      second-countable properties.
      Let $\mathcal{U} = \{ (U, \phi) \}$ be the collection of charts
      adapted to $S$ that cover $S$. Let $i: \mathbb{R}^k \to
      \mathbb{R}^n$ be the inclusion map
      $(r^1, \dots, r^k) \mapsto (r^1, \dots, r^k, 0, \dots 0)$, and
      $\pi: \mathbb{R}^n \to \mathbb{R}^k$ be the projection map
      $(r^1, \dots, r^n) mapsto (r^1, \dots, r^k)$. Given
      $(U, \phi) \in \mathcal{U}$, define
      $\phi_S : U \cap S \to \mathbb{R}^k$ by $\phi_S = \pi \circ
      \phi$. We claim that
      $\{ (U \cap S, \pi \circ \phi) \vert (U, \phi) \in \mathcal{U}
      \}$ forms a smooth atlas. The inverses
      $\phi_S^{-1} = \phi^{-1} \circ i$ give a homeomorphism, so we
      have a topological manifold. Next we wish to check smooth
      compatibility. Let $(U \cap S, \phi_S)$ and $(V \cap S, \psi_S)$
      be charts in our proposed atlas. Then
      $$
      \psi_S \circ \phi_S^{-1} = \pi \circ \psi \circ \phi^{-1} \circ i
      $$
      is a composition of smooth maps and is hence smooth.
    }
  \end{enumerate}
\end{remark}

\begin{xmpl}
An example of a space which is not a submanifold is the ``topologist's
sine curve'', which is connected but not path-connected. As a set,
$$
S = \{ (0, y) \vert -1 < y < 1 \}
\cup \{ (x, \sin\left(\frac{1}{x}\right)) \vert 0 < x < 1 \}.
$$
Because the curve accumulates on itself nontrivially at the origin, no
neighborhood of the origin looks like a copy of $\mathbb{R}^1$ in $\mathbb{R}^2$.
\end{xmpl}

\begin{defn}[Regular points, critical points]
Let $F: N^n \to M^m$ be a smooth map. We say that
$p \in N$ is \emph{regular} if
$F_{\ast, p}: T_pN^n \to T_{F(p)}M^m$ is surjective, which requires
that $n \geq m$ by the rank-nullity theorem. A point that is not
regular is called \emph{critical}. We define the \emph{critical set}
to be the set $\mathrm{Crit}(F)$ of all critical points of $F$. Points
that lie in the image of the critical set $F(\mathrm{Crit}(F))$ are
called \emph{critical values}, and points in
$M - F(\mathrm{Crit}(F))$ are called \emph{regular values}.
A point $c \in M$ is a regular value if either
\begin{enumerate}
  \item{$F^{-1}(c) = \varnothing$.}
  \item{
    If $F^{-1}(c)$ is nonempty, then each $p \in F^{-1}(c)$ is a
    regular point in $N$.
  }
\end{enumerate}
\end{defn}

\begin{theorem}[Sard's theorem]
If $F: N^n \to M^m$ is a smooth map, then almost every $m \in M$ is a
regular value, i.e. $F(\mathrm{Crit}(F))$ has Lebesgue measure zero in
$M$ -- i.e. in every chart it has Lebesgue measure zero.
In particular, if we take any open set in $M^m$, it will contain
regular values.
\end{theorem}

\begin{theorem}[Regular value theorem]
Let $F: N^n \to M^m$ be $C^\infty$, and $c \in M^m$ be a regular
value. Then if $S = F^{-1}(c)$ is nonempty, $S$ is an embedded
submanifold of $N^n$ of dimension $k = n - m$, i.e. of codimension $m$.
\end{theorem}

\begin{proof}
Let $S = F^{-1}(c) \neq \varnothing$, and $c$ be a regular value. We
need to exhibit an adapted chart for each $p \in S$. Let $(V, \psi)$
be a chart in $M^m$ centered at $c$ with coordinates $y^1, \dots,
y^m$, taking $V$ to $\mathbb{R}^m$ with local coordinates $r^1, \dots,
r^m$. Let $p \in F^{-1}(c)$. Since $F$ is continuous, $F^{-1}(V)$ is
open, so for any $p \in F^{-1}(c)$ we have a neighborhood $U$ centered
at $p$, and a coordinate function $\phi$ on $U$ since $S$ is an open
set belonging to the manifold $N^n$.
\begin{align*}
   U \cap S
&= \{ u \in U \vert F(u) = c \} \\
&= \{ u \in U \vert \psi \circ F(u) = 0 \} \\
&= \{ u \in U \vert r^i \circ \psi \circ F(u) = 0 \} \\
&= \{ u \in U \vert y^i \circ F(u) = 0 \} \\
&= \{ u \in U \vert F^i(u) = 0 \},
\end{align*}
so that $U \cap S$ is ``cut out'' by the $m$ component functions of
$F$.

We conclude by altering the chart $(U, \phi)$ to obtain a chart
$(\bar{U}, \Phi)$ for which $F^i$ are coordinate functions of $\Phi$.
In coordinates,
$$
  F_{\ast, p}
= \mathrm{Jac}(F)|_p
= \left[\frac{\partial F^i}{\partial x^j}(p)\right]
$$
is surjective by assumption. Therefore the Jacobian has an $m \times
m$ minor with nonzero determinant. Without loss of generality let this
be the minor consisting of the first $m$ columns. Define
$\Phi: U \to \mathbb{R}^n$ by
$\Phi(u) = (F^1(u), \dots, F^m(u), x^{m+1}, \dots, x^n)$. Then
$\mathrm{Jac}(\Phi)|_p$
can be decomposed as a block-diagonal matrix with the full-rank
$m \times m$ block in the top left and $I_{(n - m) \times (n - m)}$ in
the bottom right, which has nonzero determinant.

\end{proof}
